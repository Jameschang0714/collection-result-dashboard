# **專案：催收作業歸因分析與績效賦能模型**

* **專案發起人**: James, AVP, Chailease Royal Finance Plc  
* **目標**: 打破催收「行為」與「結果」的數據斷鏈，建立一套數據驅動的歸因分析模型，並將其轉化為可實際提升催收人員績效的管理工具與溝通策略。  
* **核心方法論**: 採用「歸因窗口 (Attribution Window)」模型，從「單點歸因」轉向「貢獻度分析」，科學地衡量催收活動的累積效應。

## **專案藍圖總覽**

本專案分為兩個核心階段，產出兩個關鍵數據資產，最終落地於管理層的溝通策略。

1. **第一階段：建立「案件歸因分析」數據集 (attribution\_analysis.csv)**  
   * **目的**: 為每一筆「成功回款」，繪製其在「歸因窗口期」內的完整催收活動畫像。  
2. **第二階段：建立「催收員績效賦能」數據集 (agent\_performance\_summary.csv)**  
   * **目的**: 將案件歸因數據轉化為以「催收員」為核心的績效指標，量化其「助攻價值」與「催收效率」。

## **第一階段：歸因分析 (attribution\_analysis.csv)**

### **1.1 輸入資料來源 (Input Files)**

專案需要以下兩個 CSV 檔案作為輸入：

1. **通話紀錄檔**: consolidated\_report.csv  
   * Case No: 案件編號 (需與 KPI 檔的 CNTRT\_NO 對應)  
   * Date: 通話日期  
   * Talk Durations: 通話時長  
   * Agent ID: 催收員 ID (需與 KPI 檔的 USR\_ID 對應)  
2. **催收 KPI 暨還款紀錄檔**: KH\_DM\_FACT\_COLL\_KPI\_DTL.csv  
   * CNTRT\_NO: 合約編號 (作為 Case No 使用)  
   * RCV\_DT: 實際還款日期 (作為 payment\_date 使用)  
   * RCV\_AMT\_ACTUAL: 實際還款金額 (作為 payment\_amount 使用)  
   * USR\_ID: 分派的催收員 ID (作為 Agent ID 使用)  
   * **(附加價值欄位)**: FINANCE\_TYPE, ASSIGN\_OVER\_AMT 等，可用於後續深度分析。

### **1.2 產出檔案規格 (Output File)**

* **檔名**: attribution\_analysis.csv  
* **核心結構**: 每一行代表一筆成功還款，以及其發生前「歸因窗口期」內的所有催收活動總結。  
* **關鍵欄位**:  
  * Case No: 案件編號  
  * payment\_date: 還款日期  
  * payment\_amount: 還款金額  
  * calls\_in\_window: 窗口內的總通話次數  
  * talk\_time\_in\_window: 窗口內的總通話時長 (秒)  
  * agents\_in\_window: 窗口內接觸過的所有催收員 (去重)  
  * last\_agent\_in\_window: 窗口內最後一位通話的催收員

### **1.3 程式碼：generate\_attribution\_analysis.py**

\#  
\# 檔名: generate\_attribution\_analysis.py  
\# 目的: 讀取通話紀錄與KPI檔案，生成歸因分析數據集。  
\#

import pandas as pd  
import datetime

def main():  
    """主執行函數"""  
    print("--- 開始執行第一階段：生成歸因分析檔案 \---")

    \# \--- 1\. 讀取資料 & 準備 \---  
    try:  
        calls\_df \= pd.read\_csv('consolidated\_report.csv')  
        kpi\_df \= pd.read\_csv('KH\_DM\_FACT\_COLL\_KPI\_DTL.csv')  
        print("通話紀錄與KPI檔案成功載入！")  
    except FileNotFoundError as e:  
        print(f"錯誤：找不到必要的檔案 {e.filename}。請確認檔案是否存在於同個目錄。")  
        return

    \# \--- 2\. 資料預處理 (Data Preprocessing) \---  
    print("正在進行資料預處理...")  
    \# A. 處理通話紀錄檔  
    calls\_df\['Date'\] \= pd.to\_datetime(calls\_df\['Date'\])  
    calls\_df\['Case No'\] \= calls\_df\['Case No'\].astype(str).str.strip()  
    calls\_df\['Agent ID'\] \= calls\_df\['Agent ID'\].astype(str).str.strip()  
    \# 轉換通話時長為秒  
    calls\_df\['talk\_seconds'\] \= calls\_df\['Talk Durations'\].apply(lambda x: pd.to\_timedelta(x).total\_seconds())

    \# B. 處理KPI檔案，篩選出有效還款紀錄  
    payments\_df \= kpi\_df\[kpi\_df\['RCV\_DT'\].notna() & (kpi\_df\['RCV\_AMT\_ACTUAL'\] \> 0)\].copy()  
    payments\_df\['payment\_date'\] \= pd.to\_datetime(payments\_df\['RCV\_DT'\], errors='coerce')  
    payments\_df.dropna(subset=\['payment\_date'\], inplace=True) \# 移除無法轉換日期的行

    \# 將 Case No 與 Agent ID 的欄位名稱統一  
    payments\_df.rename(columns={  
        'CNTRT\_NO': 'Case No',  
        'USR\_ID': 'Agent ID',  
        'RCV\_AMT\_ACTUAL': 'payment\_amount'  
    }, inplace=True)  
    payments\_df\['Case No'\] \= payments\_df\['Case No'\].astype(str).str.strip()

    print(f"從KPI檔案中篩選出 {len(payments\_df)} 筆有效還款紀錄。")

    \# \--- 3\. 設定歸因模型參數 \---  
    ATTRIBUTION\_WINDOW\_DAYS \= 14  
    print(f"歸因窗口期設定為 {ATTRIBUTION\_WINDOW\_DAYS} 天。")

    \# \--- 4\. 核心歸因邏輯 \---  
    print("正在對每一筆還款進行歸因計算...")  
      
    def get\_attribution\_metrics(payment\_row, all\_calls\_df):  
        end\_date \= payment\_row\['payment\_date'\]  
        start\_date \= end\_date \- datetime.timedelta(days=ATTRIBUTION\_WINDOW\_DAYS)  
        case\_no \= payment\_row\['Case No'\]  
          
        window\_calls \= all\_calls\_df\[  
            (all\_calls\_df\['Case No'\] \== case\_no) &  
            (all\_calls\_df\['Date'\] \>= start\_date) &  
            (all\_calls\_df\['Date'\] \<= end\_date)  
        \].copy()

        if window\_calls.empty:  
            return pd.Series(\[0, 0, None, None\])

        calls\_in\_window \= len(window\_calls)  
        talk\_time\_in\_window \= window\_calls\['talk\_seconds'\].sum()  
          
        agents \= sorted(window\_calls\['Agent ID'\].unique())  
        agents\_in\_window \= ', '.join(agents)  
          
        last\_agent\_in\_window \= window\_calls.sort\_values(by='Date', ascending=True).iloc\[-1\]\['Agent ID'\]  
          
        return pd.Series(\[calls\_in\_window, talk\_time\_in\_window, agents\_in\_window, last\_agent\_in\_window\])

    \# 應用函式到每一筆還款  
    attribution\_cols \= \['calls\_in\_window', 'talk\_time\_in\_window', 'agents\_in\_window', 'last\_agent\_in\_window'\]  
    payments\_df\[attribution\_cols\] \= payments\_df.apply(lambda row: get\_attribution\_metrics(row, calls\_df), axis=1)

    \# \--- 5\. 儲存結果 \---  
    print("計算完成，正在儲存結果...")  
    output\_df \= payments\_df\[\[  
        'Case No',  
        'payment\_date',  
        'payment\_amount',  
        'Agent ID', \# 案件當時分配的催收員  
        'FINANCE\_TYPE',  
        'ASSIGN\_OVER\_AMT'  
    \] \+ attribution\_cols\]

    output\_filename \= 'attribution\_analysis.csv'  
    output\_df.to\_csv(output\_filename, index=False, encoding='utf-8-sig')

    print(f"--- 第一階段完成！成功生成 \`{output\_filename}\` \---")

if \_\_name\_\_ \== '\_\_main\_\_':  
    main()

## **第二階段：績效賦能 (agent\_performance\_summary.csv)**

### **2.1 輸入資料來源 (Input Files)**

1. **歸因分析檔**: attribution\_analysis.csv (由第一階段產出)  
2. **通話紀錄檔**: consolidated\_report.csv (用以計算總工時等基礎指標)

### **2.2 產出檔案規格 (Output File)**

* **檔名**: agent\_performance\_summary.csv  
* **核心結構**: 每一行代表一位催收員的當期綜合績效總結，包含多維度的貢獻與效率指標。  
* **關鍵欄位**:  
  * Agent ID: 催收員ID  
  * total\_collections\_influenced: **總影響金額** (作為參與者的案件總還款)  
  * total\_collections\_closed: **收尾金額** (作為最後通話者的總還款)  
  * assist\_value: **助攻價值** (總影響金額 \- 收尾金額)  
  * collection\_efficiency\_ratio: **催收效率指數** (總影響金額 / 窗口內總通話秒數)  
  * avg\_touches\_per\_collection: **平均催收觸點** (影響案件的平均通話次數)  
  * total\_calls: 總外撥電話數  
  * total\_talk\_time\_sec: 總通話時長

### **2.3 程式碼：generate\_agent\_performance.py**

\#  
\# 檔名: generate\_agent\_performance.py  
\# 目的: 讀取歸因分析檔案，生成以催收員為核心的績效賦能數據集。  
\#

import pandas as pd

def main():  
    """主執行函數"""  
    print("\\n--- 開始執行第二階段：生成催收員績效賦能檔案 \---")

    \# \--- 1\. 讀取基石數據 \---  
    try:  
        attr\_df \= pd.read\_csv('attribution\_analysis.csv')  
        calls\_df \= pd.read\_csv('consolidated\_report.csv')  
        print("歸因分析檔案與通話紀錄成功載入！")  
    except FileNotFoundError as e:  
        print(f"錯誤：找不到必要的檔案 {e.filename}。請先執行第一階段。")  
        return  
          
    \# \--- 2\. 資料預處理 \---  
    calls\_df\['Agent ID'\] \= calls\_df\['Agent ID'\].astype(str).str.strip()  
    attr\_df\['agents\_in\_window'\] \= attr\_df\['agents\_in\_window'\].astype(str) \# 確保能使用 .str.contains

    \# 獲取所有不重複的催收員ID  
    all\_agents \= calls\_df\['Agent ID'\].unique()  
    agent\_summary \= \[\]

    print("正在為每一位催收員計算績效指標...")  
    \# \--- 3\. 以催收員為核心，遍歷計算績效指標 \---  
    for agent in all\_agents:  
        \# 計算基礎指標 (總通話數/時長)  
        agent\_calls\_df \= calls\_df\[calls\_df\['Agent ID'\] \== agent\]  
        agent\_total\_calls \= len(agent\_calls\_df)  
        agent\_total\_talk\_time \= pd.to\_timedelta(agent\_calls\_df\['Talk Durations'\]).sum().total\_seconds()  
          
        \# 計算歸因指標  
        influenced\_cases \= attr\_df\[attr\_df\['agents\_in\_window'\].str.contains(agent, na=False)\]  
        closed\_cases \= attr\_df\[attr\_df\['last\_agent\_in\_window'\] \== agent\]  
          
        total\_collections\_influenced \= influenced\_cases\['payment\_amount'\].sum()  
        total\_collections\_closed \= closed\_cases\['payment\_amount'\].sum()  
        assist\_value \= total\_collections\_influenced \- total\_collections\_closed  
          
        \# 計算效率指標  
        total\_talk\_time\_on\_influenced\_cases \= influenced\_cases\['talk\_time\_in\_window'\].sum()  
          
        if total\_collections\_influenced \> 0 and total\_talk\_time\_on\_influenced\_cases \> 0:  
            collection\_efficiency\_ratio \= total\_collections\_influenced / total\_talk\_time\_on\_influenced\_cases  
        else:  
            collection\_efficiency\_ratio \= 0  
              
        avg\_touches\_per\_collection \= influenced\_cases\['calls\_in\_window'\].mean() if not influenced\_cases.empty else 0  
              
        agent\_summary.append({  
            'Agent ID': agent,  
            'total\_collections\_influenced': total\_collections\_influenced,  
            'total\_collections\_closed': total\_collections\_closed,  
            'assist\_value': assist\_value,  
            'collection\_efficiency\_ratio': collection\_efficiency\_ratio,  
            'avg\_touches\_per\_collection': avg\_touches\_per\_collection,  
            'total\_calls': agent\_total\_calls,  
            'total\_talk\_time\_sec': agent\_total\_talk\_time  
        })

    \# \--- 4\. 生成最終報表 \---  
    print("計算完成，正在儲存結果...")  
    summary\_df \= pd.DataFrame(agent\_summary)  
    output\_filename \= 'agent\_performance\_summary.csv'  
    summary\_df.to\_csv(output\_filename, index=False, encoding='utf-8-sig')

    print(f"--- 第二階段完成！成功生成 \`{output\_filename}\` \---")

if \_\_name\_\_ \== '\_\_main\_\_':  
    main()

## **第三階段：管理溝通與策略落地**

產出的 agent\_performance\_summary.csv 是與催收團隊進行「教練式對話」的基礎。管理層應基於此數據，從監督者轉型為賦能者。

### **溝通範例**

* **對話「高助攻價值」的員工**:「David，數據顯示你這個月影響了大量的回款，尤其在案件前期的鋪墊工作上貢獻卓越。你的『助攻價值』是團隊最高的。我想邀請你分享你是如何進行前期破冰的，讓你的經驗成為團隊的最佳實踐。」  
* **對話「高效率指數」的員工**:「Sarah，你的『催收效率指數』非常亮眼，代表你每分鐘的通話都能創造極高的回收價值。我們能否一起分析你的溝通模式，將其提煉並複製到我們的培訓體系中？」  
* **對話「高觸點、低收尾」的員工**:「Peter，你非常勤奮，接觸客戶的次數最多。我們也注意到，在你跟進的案件中，有部分最後由其他同事完成收款。我想和你一起探討，在溝通後期是否遇到了瓶頸？公司可以提供什麼樣的支援，來幫助你打通『最後一哩路』？」

## **Gemini CLI 執行指南**

您可以將上述兩個 Python 程式碼區塊，分別存成對應的 .py 檔案。然後使用 Gemini CLI 執行。

**步驟:**

1. **建立檔案**:  
   gemini "請根據這份 Markdown，為我建立 \`generate\_attribution\_analysis.py\` 和 \`generate\_agent\_performance.py\` 這兩個 Python 檔案。"

2. **準備數據**:  
   * 將 consolidated\_report.csv 和 KH\_DM\_FACT\_COLL\_KPI\_DTL.csv 放置在與 Python 腳本相同的目錄下。  
3. **執行專案**:  
   * 依序執行兩個腳本。

python generate\_attribution\_analysis.py  
python generate\_agent\_performance.py

4. **分析結果**:  
   * 在同目錄下會生成 attribution\_analysis.csv 和 agent\_performance\_summary.csv。可將這兩個檔案導入 Excel, Google Sheets, 或其他 BI 工具進行視覺化分析與報告。